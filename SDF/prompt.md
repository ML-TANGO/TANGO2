쓸수 있는 도구는 다음과 같음

각 독립된 비닐하우스는 겉비늘, 속비늘이 있음.

각 겉비늘과 속비늘과 속비늘은 각각 좌측상단창문, 좌측하단창문, 우측상단창문, 우측하단창문이 있음.


일사량 측정은 못함. 측정하는 데이터는 다음과 같음

하우스 내의 온도, 습도, 밖의 온도, 습도, 비가오는지bool, 급수기(모터) 개폐여부


미리 저장된 데이터는 다음과 같음

각 비닐하우스의 타입(연결형, 독립형)

각 비닐하우스 별 고유 id

각 비닐하우스에 존재하는 tool(제어장치) 종류

급수기(모터)의 시간 당 물 방출량



입력될때 : 

작물정보(작물명, 생육단계)
바깥세계 환경정보(계절,절기,실행시각)

센서값(내부온도,내부습도,외부온도,외부습도,강우센서bool,풍향,풍속,좌측창문상단 개폐정도,좌측창문하단 개폐정도,우측창문상단 개폐정도,우측창문하단 개폐정도)





아니 근데 이게 성능이 좋을라면, 문제가 좀 있음.

1. 현재시점의 센서값과 정보만 전달하려하는 것 같은데, 이따위 정보로는 제대로 될 수가 없음. 과거정보를 어떻게, 무엇을, 얼마나 전달해야 '사람' 기준으로도 판단할 수 있을만큼 정확할까? 가 가장 중요함.

2. 이건 어떤 도구를 선택할지는 LAM이 하는게 맞겠는데, 그 전에 Brain은 난 아무리봐도 머신러닝쪽이 훨씬 잘할거같거든?
이유 : 학습 데이터라는게 LAM입장에선 좀 헷갈림. 자기가 생물 생장관련 전문가가 아닌데, 각 도구들 늘어놓고 필요한것들을 선택하는것 한가지 목적만 해도 빡센데, 그걸 각각 몇 퍼센티지로 할지까지 얘보고 판단하라하면 얘 반항할게 뻔한데.


그러니 내 결론은 다음과 같다.

1. 학습용 데이터는 과거와 현재의 데이터가 필요하다. 그 변화의 폭도 필요하다.
2. 각 하우스 별 천차 만별이다. 어쩌면 동일한 하우스라 할지라도 그 동네의 기후, 해발 등 다양한 요소에 의해 좌우될 수 있으므로, 그 데이터로 학습된 결과 또한 장소가 바뀐다면 전혀 다른 결과를 초래할 수 있다. 즉, 최대한 데이터가 전문가의 시선으로 보았을 때 뭔가를 정확히 판단할 수 있을 정도의 데이터여야만한다.
3. 특히, 창문 개폐의 경우 ON OFF가 아니라 %로 하고있다. 학습 데이터에서 비가 오면 다 닫아야한다고 해 두어도, 만약 모델이 '이정도면 적당하겠지' 라는 마음으로 10%정도 열어둔다면 농사를 완전히 망쳐버릴 수 있다. 이 문제가 발생하지 않도록 하기 위해서는, 닫는다, 연다, 두가지로 우선 나누고, 연다의 경우에만 % 를 추가로 정하도록 유도해야 할 필요가 있다.
3. 따라서 모델은 최소 두가지가 필요하거나, 더 많은 모델이 필요하다.

각각의 모델, 혹은 에이전트라 불릴 수 있는 그것은, 각 개체 별 다음과 같은 기능을 수행해야 한다.

1. 적정값 판단자
 - 현재 기준, 적정한 온도, 습도, 각 창문의 개폐 정도의 적당한 값을 판단한다. 이놈이 제일 중요하고 정확해야 한다.
 - 여기에 LLM과 같은 생성형 AI를 적용하는 것은 극도로 위험하다. 정확도가 90%라 치자. 2주에 한번은 잘못된 판단을 내린다는건데, 그렇다면 그 농사는 무용지물이 되고 만다.
 - 따라서 이 모델은 LLM이 아니라, 머신러닝이나 다른 학습방법으로 만들어진, 정확한 값을 뱉어내는 모델이어야 한다.
 - 근데 이게 모델일 필요도 없지 않나? 경우의 수가 상당히 적어서, 창문의 개폐만 따로 빼고, 그 외의 것은 입력된 지시대로만 수행하면 되는것이 아닐런지.


2. 도구 선택자(LAM)
 - 얘는 적정값 판단자가 판단한 목표를 수행하기 위해 가용 도구들을 둘러보고 호출해야한다.
 - 



그렇다면 예시를 뽑아보자

학습데이터 예시 :

작물,생육단계,계절,절기,실행시각,내부온도(℃),내부습도(%),외부온도(℃),외부습도,풍향,풍속(m/s),좌측창문상단 개폐정도,좌측창문하단 개폐정도,우측창문상단 개폐정도,우측창문하단 개폐정도,전체창문닫힘(Y/N)
상추,생장기,여름,소서,2024-07-10 14:00,31.8,20.3,57,620,410,남동,1.5,0,0,0,0,Y

여기서 전체창문 닫힘값을 추가로 준 것은, 창문 열고닫는 부분의 성능을 더 높이기 위함

사실 창문 여닫기를 통해 온도가 얼마나 내려갈지 판단하는 방법은 두가지 기술이 있지.
1. 자주 호출하기 
  <- 필요없는 상황에서 자주 호출해서 괜히 오류판단만 늘리면 농사 망함
2. 정말로 필요한 정보 다 주기
  <- 여기서 이제 추가로 결정해야하는것은, 성능 향상을 위해 어떤 과거데이터들을 어떻게 줄 것인가.

일사량은 없지. 그러니 지금 창문을 열었을 때 기온이 오르느냐 내리느냐, 얼마나 오를지 내릴지는 외부 내부 온도와 습도로 공식을 통해 파악할 수 있을 것 같음.
그 공식으로 창문 얼마 개방 시 온도 어느속도냐... 하려면 또 중요한건

창문의 크기가 온실 크기와 비교해서 몇%정도인지를 정확히 아는 것. 상대적 면적이지.

근데 그걸 안다고 해도 지금 일사량을 모르면 온도가 오를지 내릴지조차 알지 못함. 일사량은 필요함. 아니지. 만약 그게 없다면, 최근 온도 습도들과 그 미분값과 2중미분값을 통해 일사량과 흡사한 기능을 수행해 줄 '온도변화추이' 를 구할 순 있겠지.

Q. 이중미분값까지나 필요해? 그냥 미분값만으로 안되냐?
A. 필요함. 그래야 정확히 어떻게 될지 예측 가능함. 추이의 변화추이를 알아야함.

그렇다면 과거온도, 미분값, 이중미분값은 어느정도의 시간차의 데이터를 보여주어야 적절한가?


가장 최근 급수 시작시각, 가장 최근 급수 종료시각, 2번째로 최근 급수 시작시각, 2번째로 최근 급수 종료시각, 1시간 전 온도, 30분 전 온도, 30분 전 ~ 현재시간까지의 시간 변화 대비 온도변화, 1시간 전 ~ 30분 전까지의 시간 변화 대비 온도변화, 45분 전 ~ 15분 전까지의 시간 대비 온도변화 값엣서 1시간 15분 전 ~ 45분 전까지의 시간 변화 대비 온도변화를 뺀 값을 30으로 나눈 값(2차미분값), 예측된 다음 지점의 시간, 예측된 다음 지점의 온도

여기에다가, 추가로 그 적정값 판단자가 준 적절한 목표 온 습도를 함께 준다.

그러면 LLM은 다음과 같이 답해야 해.

창문을 연다(Y/N), 8가지 창문 열림정도 퍼센트, 물 벨브 연다(Y/N), 물 벨브 열어둘 시간 길이, 뭐 이정도네.

이걸 5분마다 이제 호출해서 목표값 도달했는지도 체크할 수 있으면 재학습의 굴레를 만들 수 있을것 같다만은.

이정도면 정리 된 듯?

---
---
---
---
---
---



자 그럼 적정한 온 습도를 제시해줄 미니모델을 위한 학습데이터와 답안지는 어떻게 작성하면 되는가.

......

이게 모델일 필요가 있나?

아니 애초에 이건 정해져 있는거아니야?

걍 fix된 값이잖아.

상추가, 몇월 어느계절 몇시에 몇도 유지해야 잘 큰다 << 이게 뭔 모델이 필요해. 
걍 인터넷 검색만 때려도 나오겠구만.

그래그럼. 그렇게 하자. 내일 데이터들만 좀 넣고, 계산하는 알고리즘 짜둔다음에, 그걸로 학습데이터 쫘악 뽑아보자. 


--------



ㅇㅋ 데이터에 대해서는 정리가 어느정도 되었다.

근데 문제는 '적합한 온도와 습도' 를 알수가 없다는 점에 있다.

이를 해결하려면 어찌해야하는가.

받은 데이터를 최적이라 생각해야하는가?
근데 그 데이터가 매일 다를 수 있잖아. 생장기에 따라서.
심은날부터 해서 말이야.
그렇다면 역시 명인의 데이터를 잘 모아서 그걸 정답이라 생각해야하는건데

그부분에 반드시 엉터리 데이터가 들어올 수 밖에 없지않겠는가.

센서의 오류거나 뭐 다른거거나.

아니면 수집하지 못하는 데이터가 있을 수도 있잖나.
이걸 정확하게 정제해서 좋은 데이터를 남겨야하는데, 이것이 정확하게 가능하겠느냐 라는 문제.

변수가 뭐가있을까. 측정하지 못하는......

이건... 상상만으론 모르겠구나. 직접 키워본다면 모를까...

그러니 우선은, 수집된 데이터가 유의미하다고 생각할 수 밖에.

---

따라서 적정 온도와 습도에 대한 결론은 다음과 같음

info table
작물명, 생육단계, 심은 날짜, 지금의 절기, 계절, 날짜, 시간, 내부기온, 내부습도, 외부기온, 외부습도, 풍향, 풍량, 내측좌상단창문 열림정도, 내측좌하단창문 열림정도, 내측우상단창문 열림정도, 내측우하단창문 열림정도, 외측좌상단창문 열림정도, 외측좌하단창문 열림정도, 외측우상단창문 열림정도, 외측우하단창문 열림정도

action table
작물명 생육단계, 심은 날짜, 지금의 절기, 계절, 날짜, 시간, 액션

action meta table
action 명, action 설명

을 바탕으로 수집된 데이터들을 보고, 실제 농업인들이 어떤 기온이나 습도가 되도록 관리하는지를, 자동화 도입 전 수집을 한 다음, 그걸 그대로 사용.

? 그럼 창문열림정도는요? 

---









그럼 전체적인 업무 플로우는 다음과 같음.

1. 데이터 수집
 - 센서정보들과 온도정보들을 수집하여 어떤식으로 육성시킬것인지 판단할 수 있는 데이터 수집

2. 적정 온습도 판단 모듈 개발
 - 학습이 필요하겠지. 아마도 데이터 기반 머신러닝. 성능에 따라 다르게 해야할지도 모름.

3. LAM 학습용 데이터 생성
 - 주어진 도구와, 적정 온습도를 포함한 현재와 과거의 센서데이터들을 토대로 올바른 판단을 라벨링한 데이터



시스템의 플로우는 다음과 같음.

1. 데이터 수집
 - 해당 환경의 데이터들을 수집함

2. 데이터 정제
 - 이상치 걸러냄

3. 적정 온습도 판단 모듈용 input data 생성
 - 정제된 데이터를 활용하여 생성

3. 적정 온습도 판단 모듈 실행
 - input : 적정 온습도 판단 모듈용 input data
 - output : 적정 온도, 습도

4. LAM input data 생성
 - 정제된 데이터, 적정 온습도 데이터를 모두 활용하여 생성

5. LAM 실행
 - input : LAM input data
 - output : 기능(창문 여닫기, 물 주기 등) 호출



 --------

 지금 상황에서는 데이터가 수집되진 않았음. 이 상황에서 LAM 학습 데이터를 테스트용으로 만들려면 어찌해야하나.

 근데 LAM... 난 얘가 너무 믿음직스럽지 않다는 문제가 있음.

 동일한 RAM과 컴퓨터 자원을 소모하는데, LAM은 그 안에 이미 포함된 기능으로 각종 언어능력이 포함되어있음. 불필요함. 불필요함은 곧 낭비임. 애초에 부족한 컴퓨터자원인데, 거기에 불필요한 낭비가 포함되어있다는 것은, 필연적으로 정확도가 낮아짐을 의미함.
 
 학습데이터는 일단 최대한 현장과 맞게끔 구성해두어야 함.

 창문 8개, 센서데이터는 내부 외부 각 평균치.

 중요한 것은, 어떤 과거데이터들을 사용할지 확실히 정하는 것인데, 뭐 이것도 얼추 정해졌지. 알고리즘을 잘 짜서 그 데이터를 만들어내는 부분의 함수만 구현하면 돼.

 가상 데이터를 만들고 검수를 어찌하나.

 데이터를 가상이되 품질이 나쁘진 않은 수준으로 만드는 방법........

 1. 데이터를 csv로 쓸 수 있는 형식으로 정확하게 정의
 2. LAM 학습용 데이터에 필요한 칼럼명을 csv형태로 정의
 3. 1번의 데이터를 학습용 데이터로 만들기 위해 필요한 변형 과정을 코드로 작성한다.
  3.1. 목업으로 적절온습도도 추가
 4. 1번 데이터의 예시를 필요한 만큼 만든다
 5. 3번 코드를 통해 2번 csv의 내용을 채운다.
 6. LAM 학습, 테스트





---

생각해보니 문제가 있다.

지금 수집하는 정보로는 생장정보를 알수가 없다.

예를들어 토마토를 기르는데

3주만에 되게 잘 커서 과실이 잘 열렸다고 치자.

그럼 이젠 생장단계가 거의 완료되었으니 수확을 해야한다.

그런데 겨울에 다시 하니까, 아무래도 느리게 자라서 3주가 지났는데 이제 열매가 맺힐까 말까 한다고 생각해보자.

이런 경우 어떻게 해야하는가?

단순히 심은 날짜와 오늘 날짜와의 차이를 통해 생장상태를 알지는 못한다는 문제다.



다만, 어느정도 유추는 할 수 있는 방법이 있다.

일사량, 일간 온도변화, 습도변화가 거의 비슷한 형태라면, 같은 기간동안 비슷한 성장을 했을 것이다.

이런 식으로 유추를 하기 위해서는, 생장상태만을 예측하는 모델이 따로 필요하다...

일단 이 부분은 목업단계에선 스킵.



----

데이터 만들기 프롬프트 : 

내가 지금 준 것은 column name 정의임. 지금 현재는 date,time,indoor_temperature,indoor_humidity column만 데이터가 채워져있고 나머진 값이 없음.

이 빈 값의 내용들은 나중에는 실제 센서데이터 기반으로 채워지겠지만, 지금 가짜로 데이터를 만들어야 함. 다만 어느정도는 사실적인 느낌으로 만들고자 하는데, 

작물명은 반드시 당근
house_id는 반드시 0
planting_date는 6월 10일



---


