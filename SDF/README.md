# SDF (Smart Data Farming) 프로젝트

## 📋 프로젝트 개요

SDF는 스마트 농업을 위한 데이터 처리 및 AI 기반 자동화 시스템입니다. 온실 환경 데이터를 수집, 분석하고, AI 챗봇을 통해 스마트홈 제어를 제공합니다.

## 🏗️ 프로젝트 구조

```
SDF/
├── 1_sensor_data_maker.py          # 센서 데이터 수집 및 CSV 변환
├── 2_merge_kma_data.py             # 기상청 데이터와 센서 데이터 병합
├── 3_update_outdoor_columns.py     # 외부 환경 데이터 업데이트
├── chatbot.py                      # AI 챗봇 인터페이스
├── data_algorism.py               # 농업 데이터 알고리즘 정의
├── train.ipynb                    # 모델 훈련 노트북
├── data/                          # 데이터 저장소
│   ├── data_alaysis/              # 데이터 분석 결과
│   ├── kma_data/                  # 기상청 데이터
│   └── *.csv                      # 처리된 데이터 파일들
└── model/                         # AI 모델
    └── fine_tuned_xlm_lora/       # LoRA 파인튜닝된 모델
```

## 🚀 주요 기능

### 1. 데이터 수집 및 처리
- **센서 데이터 수집**: 온습도 센서 데이터를 CSV 형태로 변환
- **기상청 데이터 병합**: KMA(기상청) 데이터와 센서 데이터를 시간 기준으로 병합
- **데이터 정제**: 외부 환경 데이터 업데이트 및 정규화

### 2. AI 기반 스마트홈 제어
- **자연어 처리**: 사용자의 자연어 명령을 이해하고 적절한 액션 제안
- **스마트홈 도구**: 창문 개폐, 급수, 조명 제어 등
- **실시간 대화**: 대화형 챗봇 인터페이스

### 3. 농업 데이터 분석
- **환경 모니터링**: 온도, 습도, 일조량 등 실시간 모니터링
- **예측 분석**: 온도 변화율 및 미래 온도 예측
- **작물별 최적 환경**: 토마토, 무 등 작물별 적정 환경 기준 제공

## 🛠️ 사용 방법

### 환경 설정
```bash
# 필요한 라이브러리 설치
pip install pandas numpy torch transformers peft
```

### 데이터 처리 파이프라인
```bash
# 1. 센서 데이터 수집
python 1_sensor_data_maker.py

# 2. 기상청 데이터 병합
python 2_merge_kma_data.py

# 3. 외부 환경 데이터 업데이트
python 3_update_outdoor_columns.py
```

### AI 챗봇 실행
```bash
python chatbot.py
```

## 📊 데이터 구조

### 센서 데이터
- **내부 환경**: 온도, 습도
- **외부 환경**: 온도, 습도, 풍향, 풍속
- **창문 상태**: 좌우, 상하 창문 개폐 정도 (0-100%)
- **급수 이력**: 최근 급수 시작/종료 시각

### 분석 데이터
- **온도 변화율**: 5분, 10분, 30분, 1시간 전 온도 비교
- **2차 미분값**: 단기/장기 온도 변화 가속도
- **예측 데이터**: 다음 시점 온도 예측

## 🤖 AI 모델

### 기본 모델
- **Base Model**: Salesforce/xLAM-1b-fc-r
- **Fine-tuning**: LoRA (Low-Rank Adaptation) 방식
- **도구 사용**: JSON 형태의 액션 생성

### 지원 도구
1. **창문 제어**: `open_left_window`, `open_right_window`
2. **급수 제어**: `supply_water`
3. **조명 제어**: `light_on`, `light_off`

## 📈 분석 결과

### 주요 발견사항
- **일조량과 온도의 관계**: 낮 시간대에 일조량과 온도가 상관관계를 보임
- **계절별 차이**: 여름철에는 창문이 상시 개방, 봄/가을/겨울에는 환기 필요
- **작물별 최적 환경**: 토마토(24℃, 65%), 무(20-23℃) 등

## 🔧 개발 환경

- **Python**: 3.x
- **주요 라이브러리**: pandas, numpy, torch, transformers, peft
- **모델**: xLAM-1b-fc-r + LoRA
- **데이터**: CSV 형태의 시계열 데이터

## 📝 참고사항

- 데이터는 5분 간격으로 수집
- 기상청 데이터는 시간별로 보간 처리
- 농가 인터뷰를 통한 실제 농업 지식 반영
