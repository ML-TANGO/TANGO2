
[PARSER]
    name    jfb-remove-training-header
    format  regex
    regex   /^\[FLIGHTBASE\]\s*(?<log>[\s\S]*)$/mi

[PARSER]
    name    training-json
    format  json

[MULTILINE_PARSER]
    name          multiline-python-trace
    type          regex
    flush_timeout 3000
    rule      "start_state" "/Traceback /"   "type"
    rule      "traceback"   "/Traceback /"   "type"
    rule      "type"        "/^[ \\t]+File/"     "code"
    rule      "type"        "/^(?:[^\\s.():]+\\.)*[^\\s.():]+:/" "traceback"
    rule      "type"        "/^[ \\t]+[\\~\\^]+/"   "type"
    rule      "code"        "/^[ \\t]+/"     "type"

[MULTILINE_PARSER]
    name          multiline-custom
    type          regex
    flush_timeout 3000
    rule    "start_state"   "/(Multiline|Multi?Ln?)(S|Start|Begin)/i"         "cont"
    rule    "cont"          "/^-.*(Multiline|Multi?Ln?)(E|End|Stop|Finish)/i" "finish"
    rule    "cont"          "/^\| /"               "cont" 
    rule    "finish"        "/$ never match/"       "finish"

[PARSER]
    name    jfb-extract-level
    format  regex
    regex   /^\[JFB\/(?<_cat_level>[^\] \/]*)[^\]]*\]\s*(?<jfb_log>.*)$/mi

[PARSER]
    name    resource-extract-level
    format  regex
    regex   /^\[RESOURCE\/(?<_cat_level>[^\] \/]*)[^\]]*\]\s*(?<jfb_log>.*)$/mi

[PARSER]
    name    jfb-extract-user-json-body
    format  regex
    regex   /^\[FLIGHTBASE\]\s*(?<jfb_user_json>.*)$/mi
